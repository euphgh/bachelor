% !Mode:: "TeX:UTF-8"

\hitsetup{
  %******************************
  % 注意：
  %   1. 配置里面不要出现空行
  %   2. 不需要的配置信息可以删除
  %******************************
  %
  %=====
  % 秘级
  %=====
  statesecrets={公开},
  natclassifiedindex={TM301.2},
  intclassifiedindex={62-5},
  %
  %=========
  % 中文信息
  %=========
% ctitleone={高性能RISC-V开源处理},%本科生封面使用
% ctitletwo={器虚拟化扩展与系统评测},%科生封面使用
  ctitlecover={高性能RISC-V开源处理器\\虚拟化扩展与系统评测},%放在封面中使用，自由断行
  ctitle={高性能RISC-V开源处理器虚拟化扩展与系统评测},%放在原创性声明中使用
  % csubtitle={一条副标题}, %一般情况没有，可以注释掉
  cxueke={工学},
  csubject={计算机科学与技术},
  caffil={计算学部},
  cauthor={胡光辉},
  csupervisor={黄庆成副教授},
  cassosupervisor={某某某教授}, % 副指导老师
  ccosupervisor={某某某教授}, % 联合指导老师
  % 如果是深圳本科毕业论文，需要取消注释下一行，并将内容改为“规范”中要求的封面第一页最下方的日期
% szshortcdate={2024年6月},
  % 日期自动使用当前时间，若需指定按如下方式修改：
cdate={2024年5月26日},
  cstudentid={120L052208},
  % cstudenttype={学术学位论文}, %非全日制教育申请学位者
  % cnumber={no9527}, %编号
  % cpositionname={哈铁西站}, %博士后站名称
  % cfinishdate={20XX年X月---20XX年X月}, %到站日期
  % csubmitdate={20XX年X月}, %出站日期
  % cstartdate={3050年9月10日}, %到站日期
  % cenddate={3090年10月10日}, %出站日期
  %（同等学力人员）、（工程硕士）、（工商管理硕士）、
  %（高级管理人员工商管理硕士）、（公共管理硕士）、（中职教师）、（高校教师）等
  %
  %
  %=========
  % 英文信息
  %=========
etitle={High performance RISC-V open source processor hypervisor extension and systm evaluation},
  esubtitle={This is the sub title},
  exueke={Engineering},
  esubject={Computer Science and Technology},
  eaffil={\emultiline[t]{School of Mechatronics Engineering \\ Mechatronics Engineering}},
  eauthor={Yu Dongmei},
  esupervisor={Professor XXX},
  eassosupervisor={XXX},
  % 日期自动生成，若需指定按如下方式修改：
  edate={December, 2017},
  estudenttype={Master of Art},
  %
  % 关键词用“英文逗号”分割
ckeywords={RISC-V, 高性能处理器, 虚拟化, 系统评测},
ekeywords={RISC-V, high-performance processor, virtualization, system evaluation},
}

\begin{cabstract}
本文的研究目的是以高性能RISC-V开源处理器“香山”为基础，构建了一个支持虚拟化的软硬件系统。
虚拟化是一项在云计算和数据中心中广泛使用的技术。
在需求的推动下，主流计算机体系结构已纷纷实现了虚拟化的硬件扩展支持。
RISC-V作为一种新兴的开源指令集，也开始关注云数据中心的需求，提出了处理器的虚拟化扩展规范，为研究提供了巨大的空间。
本文的研究内容可分为三部分，首先在硬件级别对处理器进行虚拟化扩展的微架构设计，
然后基于硬件平台对虚拟机管理软件进行适配，尝试在处理器中启动管理软件和虚拟机。
最后对软硬件整体进行系统级评测。

在处理器微架构方面，
虚拟化扩展主要是对“香山”的特权管理单元和虚拟内存单元两部分的功能扩展。
在虚拟内存单元方面，本文采用了分布式的一级页表缓存和集中式的地址翻译引擎，以平衡翻译速度和时序压力。
通过添加第二阶段地址翻译单元、实现了第二阶段页表翻译。
还通过复用二级页表缓存、猝发传输获取页表、压缩一级页表缓存表项等的微架构加快了翻译速度。

在虚拟机管理软件方面，
本文在添加虚拟化扩展后的“香山”上启动了Linux，并对主机性能进行系统级评测。
同时，对硬件设计实现的调试工具进行了探索，
本文尝试了在差分测试系统中使用体系结构检查点，帮助跳过仿真操作系统启动的冗长时间。
还尝试扩展FPGA加速仿真平台获取体系结构信息的能力，力求在高效仿真的基础上实现精确定位出错现场。

本文得出的结论是：该研究实现了一个RISC-V指令集的、支持处理器虚拟化扩展的软硬件系统，
该系统以高性能乱序处理器“香山”为底层硬件，以Linux-KVM为系统软件。
虚拟化扩展对处理器在操作系统中的主机性能影响微乎其微。
此外，还尝试并改进了现有的处理器硬件调试工具，增强其功能和适用性，取得阶段性成果。

\end{cabstract}

\begin{eabstract}
The purpose of this paper is to build a virtualization-enabled hardware and software system based on a high-performance RISC-V open-source processor "XiangShan".
Virtualization is a widely used technology in cloud services and data centers.
Driven by demand, mainstream computer architectures have implemented hardware extensions to support virtualization.
RISC-V, as an emerging open source instruction set,
has also started to focus on the needs of cloud data centers by proposing a virtualization extension specification for processors,
which provides a huge space for research.
About the research content of this paper can be divided into three parts, firstly, the micro-architecture design of hypervisor extension of processors at the hardware level.
Then based on the hardware platform to adapt the virtual machine management software, try to start the management software and virtual machine in the processor.
Finally, the hardware and software as a whole are evaluated at the system level.

In terms of processor microarchitecture,
the implementation of hypervisor extension mainly requires the expansion of XiangShan's privilege management unit and memory manage unit.
For the virtual memory unit, A distributed TLB level 1 cache and a centralized address translation engine are adopts to balance the translation speed and timing pressure.
The second-stage page table translation is realized by adding a second-stage address translation unit.
The translation speed is also accelerated by a micro-architecture that reuses the TLB of the second-stage page table cache, fetches the page table by burst transfers, and compresses the table entries of the first-stage page table cache.

In terms of virtual machine management software,
Linux is booted on "XiangShan" with hypervisor extensions,
In OS, a system-level evaluation of the host performance is conducted.
Meanwhile, debugging tools for hardware design implementation are explored.
architectural checkpoints is applied in the difftest system to help skip the long boot time of the emulated OS.
we also tries to extend the ability of FPGA-accelerated simulation platforms to obtain architecture information, and strives to achieve precise location of the error site on the basis of efficient simulation.
  
This paper concludes that we implements a hardware and software system of RISC-V instruction set that supports the hypervisor extension of processor.
The system use a high-performance out of ordered processor "XiangShan" as the underlying hardware and Linux-KVM as the system software.
Hypervisor extensions have a minimal impact on the processor's host performance in the operating system.
Existing debugging tools for processor hardware design have limited debugging capabilities in virtualization scenarios.
There is an urgent need for a debugging platform that can both obtain architecture information and fast simulation.
\end{eabstract}
